import json
res = json.loads(
    """[
    {
      "functionId": 3764,
      "permissionCode": 2974,
      "functionName": "查看二维码管理",
      "controlled": 1,
      "availableInBuffer": -1,
      "availableOutBuffer": 0,
      "authType": 1,
      "quoted": 0,
      "affectMenuDisplay": 1,
      "rank": null,
      "creator": "suhailun02",
      "createdTime": 1653902341000,
      "modifier": "suhailun02",
      "modifiedTime": 1654846237000,
      "resourceState": 2,
      "menuCode": null,
      "rootApplied": 1,
      "orgPoiApplied": 0,
      "singlePoiApplied": 1,
      "adminApplied": 0,
      "bizNode": "testkey_permission_5.19.60闪电S13_1"
    },
    {
      "functionId": 3766,
      "permissionCode": 2976,
      "functionName": "编辑二维码管理",
      "controlled": 1,
      "availableInBuffer": -1,
      "availableOutBuffer": 0,
      "authType": 1,
      "quoted": 0,
      "affectMenuDisplay": 1,
      "rank": null,
      "creator": "suhailun02",
      "createdTime": 1653902379000,
      "modifier": "suhailun02",
      "modifiedTime": 1654846237000,
      "resourceState": 2,
      "menuCode": null,
      "rootApplied": 1,
      "orgPoiApplied": 0,
      "singlePoiApplied": 1,
      "adminApplied": 0,
      "bizNode": "testkey_permission_5.19.60闪电S13_1"
    },
    {
      "functionId": 6448,
      "permissionCode": 5670,
      "functionName": "查看桌台点餐码",
      "controlled": 1,
      "availableInBuffer": -1,
      "availableOutBuffer": 0,
      "authType": 1,
      "quoted": 0,
      "affectMenuDisplay": 1,
      "rank": null,
      "creator": "suhailun02",
      "createdTime": 1678868873000,
      "modifier": "suhailun02",
      "modifiedTime": 1678868873000,
      "resourceState": 1,
      "menuCode": null,
      "rootApplied": 1,
      "orgPoiApplied": 0,
      "singlePoiApplied": 1,
      "adminApplied": 0,
      "bizNode": "0"
    },
    {
      "functionId": 6449,
      "permissionCode": 5671,
      "functionName": "编辑桌台点餐码",
      "controlled": 1,
      "availableInBuffer": -1,
      "availableOutBuffer": 0,
      "authType": 1,
      "quoted": 0,
      "affectMenuDisplay": 1,
      "rank": null,
      "creator": "suhailun02",
      "createdTime": 1678868883000,
      "modifier": "suhailun02",
      "modifiedTime": 1678868883000,
      "resourceState": 1,
      "menuCode": null,
      "rootApplied": 1,
      "orgPoiApplied": 0,
      "singlePoiApplied": 1,
      "adminApplied": 0,
      "bizNode": "0"
    },
    {
      "functionId": 6450,
      "permissionCode": 5672,
      "functionName": "查看门店点餐码",
      "controlled": 1,
      "availableInBuffer": -1,
      "availableOutBuffer": 0,
      "authType": 1,
      "quoted": 0,
      "affectMenuDisplay": 1,
      "rank": null,
      "creator": "suhailun02",
      "createdTime": 1678868896000,
      "modifier": "suhailun02",
      "modifiedTime": 1678868896000,
      "resourceState": 1,
      "menuCode": null,
      "rootApplied": 1,
      "orgPoiApplied": 0,
      "singlePoiApplied": 1,
      "adminApplied": 0,
      "bizNode": "0"
    },
    {
      "functionId": 6451,
      "permissionCode": 5673,
      "functionName": "编辑门店点餐码",
      "controlled": 1,
      "availableInBuffer": -1,
      "availableOutBuffer": 0,
      "authType": 1,
      "quoted": 0,
      "affectMenuDisplay": 1,
      "rank": null,
      "creator": "suhailun02",
      "createdTime": 1678868904000,
      "modifier": "suhailun02",
      "modifiedTime": 1678868904000,
      "resourceState": 1,
      "menuCode": null,
      "rootApplied": 1,
      "orgPoiApplied": 0,
      "singlePoiApplied": 1,
      "adminApplied": 0,
      "bizNode": "0"
    },
    {
      "functionId": 6452,
      "permissionCode": 5674,
      "functionName": "查看品牌点餐码",
      "controlled": 1,
      "availableInBuffer": -1,
      "availableOutBuffer": 0,
      "authType": 1,
      "quoted": 0,
      "affectMenuDisplay": 1,
      "rank": null,
      "creator": "suhailun02",
      "createdTime": 1678868914000,
      "modifier": "suhailun02",
      "modifiedTime": 1678868914000,
      "resourceState": 1,
      "menuCode": null,
      "rootApplied": 1,
      "orgPoiApplied": 0,
      "singlePoiApplied": 1,
      "adminApplied": 0,
      "bizNode": "0"
    },
    {
      "functionId": 6453,
      "permissionCode": 5675,
      "functionName": "编辑品牌点餐码",
      "controlled": 1,
      "availableInBuffer": -1,
      "availableOutBuffer": 0,
      "authType": 1,
      "quoted": 0,
      "affectMenuDisplay": 1,
      "rank": null,
      "creator": "suhailun02",
      "createdTime": 1678868923000,
      "modifier": "suhailun02",
      "modifiedTime": 1678868923000,
      "resourceState": 1,
      "menuCode": null,
      "rootApplied": 1,
      "orgPoiApplied": 0,
      "singlePoiApplied": 1,
      "adminApplied": 0,
      "bizNode": "0"
    },
    {
      "functionId": 6454,
      "permissionCode": 5676,
      "functionName": "查看门店主页码",
      "controlled": 1,
      "availableInBuffer": -1,
      "availableOutBuffer": 0,
      "authType": 1,
      "quoted": 0,
      "affectMenuDisplay": 1,
      "rank": null,
      "creator": "suhailun02",
      "createdTime": 1678868936000,
      "modifier": "suhailun02",
      "modifiedTime": 1678868936000,
      "resourceState": 1,
      "menuCode": null,
      "rootApplied": 1,
      "orgPoiApplied": 0,
      "singlePoiApplied": 1,
      "adminApplied": 0,
      "bizNode": "0"
    },
    {
      "functionId": 6455,
      "permissionCode": 5677,
      "functionName": "编辑门店主页码",
      "controlled": 1,
      "availableInBuffer": -1,
      "availableOutBuffer": 0,
      "authType": 1,
      "quoted": 0,
      "affectMenuDisplay": 1,
      "rank": null,
      "creator": "suhailun02",
      "createdTime": 1678868945000,
      "modifier": "suhailun02",
      "modifiedTime": 1678868945000,
      "resourceState": 1,
      "menuCode": null,
      "rootApplied": 1,
      "orgPoiApplied": 0,
      "singlePoiApplied": 1,
      "adminApplied": 0,
      "bizNode": "0"
    },
    {
      "functionId": 6456,
      "permissionCode": 5678,
      "functionName": "查看微信小程序码",
      "controlled": 1,
      "availableInBuffer": -1,
      "availableOutBuffer": 0,
      "authType": 1,
      "quoted": 0,
      "affectMenuDisplay": 1,
      "rank": null,
      "creator": "suhailun02",
      "createdTime": 1678868965000,
      "modifier": "suhailun02",
      "modifiedTime": 1678868965000,
      "resourceState": 1,
      "menuCode": null,
      "rootApplied": 1,
      "orgPoiApplied": 0,
      "singlePoiApplied": 1,
      "adminApplied": 0,
      "bizNode": "0"
    },
    {
      "functionId": 6457,
      "permissionCode": 5679,
      "functionName": "编辑微信小程序码",
      "controlled": 1,
      "availableInBuffer": -1,
      "availableOutBuffer": 0,
      "authType": 1,
      "quoted": 0,
      "affectMenuDisplay": 1,
      "rank": null,
      "creator": "suhailun02",
      "createdTime": 1678868973000,
      "modifier": "suhailun02",
      "modifiedTime": 1678868973000,
      "resourceState": 1,
      "menuCode": null,
      "rootApplied": 1,
      "orgPoiApplied": 0,
      "singlePoiApplied": 1,
      "adminApplied": 0,
      "bizNode": "0"
    },
    {
      "functionId": 6458,
      "permissionCode": 5680,
      "functionName": "制作空码",
      "controlled": 1,
      "availableInBuffer": -1,
      "availableOutBuffer": 0,
      "authType": 1,
      "quoted": 0,
      "affectMenuDisplay": 1,
      "rank": null,
      "creator": "suhailun02",
      "createdTime": 1678868995000,
      "modifier": "suhailun02",
      "modifiedTime": 1678868995000,
      "resourceState": 1,
      "menuCode": null,
      "rootApplied": 1,
      "orgPoiApplied": 0,
      "singlePoiApplied": 1,
      "adminApplied": 0,
      "bizNode": "0"
    }
  ]"""
)
print(type(res))
# map res array to a map only contain functionId and permissionCode and functionName
res = list(map(lambda i: {
           'permissionCode': i['permissionCode'], 'functionName': i['functionName']}, res))


newRes = list(res)
for i in newRes:
    if i['functionName'].startswith('查看'):
        i['viewId'] = i['permissionCode']
        del i['permissionCode']
        res.append(i)

    elif i['functionName'].startswith('编辑'):
        i['editId'] = i['permissionCode']
        del i['permissionCode']
        res.append(i)
    else:
        res.append(i)

res = list()
for i in newRes:
    if i['functionName'].startswith('查看') or i['functionName'].startswith('编辑'):
        i['functionName'] = i['functionName'][2:]
        res.append(i)


print(res)

merged = []
for obj in arr:
    functionName = obj['functionName']
    rest = {k: v for k, v in obj.items() if k != 'functionName'}
    existing = next(
        (item for item in merged if item['functionName'] == functionName), None)
    if existing:
        existing.update(rest)
    else:
        merged.append(obj)
